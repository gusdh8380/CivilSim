# CivilSim 개발 로드맵

심시티 스타일 토목/건축 시뮬레이터 단계별 개발 계획.

---

## Phase 0 — 환경 세팅 ✅

> 목표: 개발 가능한 기반 완성

- [x] Unity 6 프로젝트 생성 (WebGL)
- [x] Git 레포지토리 구성 + .gitignore
- [x] URP / Cinemachine / InputSystem 패키지 설치
- [x] GitHub Actions WebGL 자동 빌드 워크플로우
- [x] CLAUDE.md 아키텍처 가이드
- [ ] 브랜치 전략 적용 (`main` / `develop`)
- [x] GitHub 원격 레포지토리 연결

---

## Phase 1 — 코어 기초 시스템 ✅
> 목표: 게임이 돌아가는 뼈대 완성

### 1-1. 그리드 시스템
- [x] `GridSystem.cs` — 100×100 타일 데이터 관리
- [x] `GridCell.cs` — 셀 상태 (Empty / Road / Building / Zone)
- [x] `GridVisualizer.cs` — 그리드 라인 오버레이 (GL.Lines)
- [x] 월드 좌표 ↔ 그리드 좌표 변환 (`WorldToGrid` / `GridToWorld`)
- [x] 멀티레이어 지원 (CellState: Empty/Road/Building/Zone)

### 1-2. RTS 카메라
- [x] `RTSCameraController.cs`
  - Pan: WASD / 방향키 / 화면 가장자리 / 중클릭 드래그
  - Zoom: 마우스 휠
  - Orbit: Alt + 드래그
  - 카메라 경계 클램핑
- [ ] Cinemachine Virtual Camera 연동 _(후순위)_
- [ ] WebGL 터치/모바일 제스처 _(Phase 8에서 처리)_

### 1-3. 게임 매니저 & 이벤트 버스
- [x] `GameManager.cs` — 싱글턴, 서브시스템 참조 허브
- [x] `GameEventBus.cs` — 제네릭 Pub/Sub 이벤트 버스
- [x] `GameClock.cs` — 게임 시간, 배속 (Pause/1x/2x/4x)
- [x] `TickSystem.cs` — DailyTick / MonthlyTick 분배

### 1-4. 씬 구조
- [ ] `Boot.unity` _(Phase 7에서 처리)_
- [ ] `MainMenu.unity` _(Phase 7에서 처리)_
- [x] `GamePlay.unity` — 씬 구성 완료

---

## Phase 2 — 건물 배치 시스템 🔄
> 목표: 플레이어가 건물을 놓고 지울 수 있다

### 2-1. 건물 데이터 모델
- [x] `BuildingData.cs` (ScriptableObject)
  - 이름, 카테고리, 크기, 비용, 인구/고용, 유틸리티, 프리팹/아이콘
- [x] `BuildingDatabase.cs` — 전체 건물 목록 ScriptableObject
- [x] `BuildingInstance.cs` — 런타임 건물 상태
- [x] 기본 BuildingData 에셋 생성 (씬 구성 시 완료)

### 2-2. 건물 배치/철거
- [x] `BuildingPlacer.cs` — 고스트 미리보기 (초록/빨강), 연속 배치
- [x] `BuildingManager.cs` — 배치 실행, 카테고리별 색상 큐브
- [x] 회전 지원 (R키)
- [x] 배치 불가 조건: 겹침, 그리드 범위 초과
- [x] 철거 모드
- [x] `BuildingPlacedEvent` / `BuildingRemovedEvent` 발행

### 2-3. 건물 UI 패널
- [ ] 하단 건물 선택 패널 (카테고리 탭)
- [ ] 건물 정보 툴팁 (비용, 효과)
- [ ] 선택된 건물 하이라이트

---

## Phase 3 — 도로 & 구역 시스템
> 목표: 도로로 연결하고 구역을 지정할 수 있다
> 예상 기간: 3주

### 3-1. 도로 시스템
- [ ] `RoadBuilder.cs` — 클릭+드래그 도로 직선 생성
- [ ] `RoadManager.cs` — 도로 네트워크 그래프 관리
- [ ] 교차로 자동 감지 및 메시 업데이트
- [ ] 도로 등급: 소로/대로/고속도로
- [ ] 도로 철거

### 3-2. 구역 지정 (Zoning)
- [ ] 구역 타입: 주거(R) / 상업(C) / 공업(I)
- [ ] `ZoneManager.cs` — 클릭+드래그 면적 지정
- [ ] 구역 색상 오버레이 (반투명)
- [ ] 구역 → 도로 접근 시 자동 건물 생성 (자동 개발)
- [ ] `ZonedEvent` 발행

### 3-3. 경량 교통 시뮬레이션
- [ ] 도로망 기반 이동 경로 계산 (A* 또는 플로우 필드)
- [ ] 교통 혼잡도 수치 (%)
- [ ] 혼잡 시 주민 불만족 연동

---

## Phase 4 — 시뮬레이션 엔진
> 목표: 도시가 살아 움직이는 느낌
> 예상 기간: 3~4주

### 4-1. 인구 시스템
- [ ] `PopulationManager.cs` — 총 인구, 주거/직업 수요/공급
- [ ] 인구 성장 조건: 주거 구역 + 도로 + 행복도
- [ ] 인구 감소 조건: 높은 세금, 범죄, 오염
- [ ] `HappinessCalculator.cs` — 행복도 지수 (교육/의료/오락/안전)
- [ ] 연령대별 인구 분포 (선택)

### 4-2. 경제 시스템
- [ ] `EconomyManager.cs` — 도시 자금 관리
- [ ] 수입: 주거세 / 상업세 / 공업세 (인구 × 세율)
- [ ] 지출: 건물 유지비 / 서비스 비용
- [ ] 월별 예산 정산 (`TickSystem` 연동)
- [ ] 파산 조건 및 게임오버
- [ ] 자금 부족 경고 알림

### 4-3. 유틸리티 네트워크
- [ ] 전기: 발전소 → 전선탑 → 건물 연결 그래프
- [ ] 수도: 정수장 → 파이프 → 건물 연결
- [ ] 전기/수도 미연결 건물: 기능 정지
- [ ] 유틸리티 오버레이 뷰 (전기망, 수도망 시각화)

---

## Phase 5 — 공공시설 & 도시 서비스
> 목표: 도시 경영의 깊이 추가
> 예상 기간: 2주

- [ ] **소방서** — 화재 반경 커버리지
- [ ] **경찰서** — 치안 반경
- [ ] **병원** — 의료 서비스 반경
- [ ] **학교/대학** — 교육 수준 향상
- [ ] **공원/레저** — 행복도 보너스
- [ ] **쓰레기 처리장** — 오염도 감소
- [ ] 서비스 커버리지 오버레이 (반경 시각화)

---

## Phase 6 — 토목 & 특수 시설
> 목표: 시뮬레이터의 핵심 차별화 요소
> 예상 기간: 3주

- [ ] **터레인(지형) 편집** — 고저차, 언덕, 평탄화
- [ ] **교량** — 강/계곡 위 도로 연결
- [ ] **터널** — 산 관통 도로
- [ ] **댐** — 수위 조절, 홍수 방어, 발전
- [ ] **항구** — 해안 무역 수입
- [ ] **공항** — 관광/인구 유입 보너스
- [ ] 지형 고저차에 따른 건물 배치 제한

---

## Phase 7 — UI/UX 완성
> 목표: 실제 게임처럼 느껴지는 인터페이스
> 예상 기간: 2주

- [ ] **HUD** — 자금, 인구, 날짜, 행복도 바
- [ ] **미니맵** — 도시 전체 조감도 (RenderTexture)
- [ ] **정보 패널** — 도시 통계 그래프 (인구/세수 추이)
- [ ] **알림 시스템** — 재해, 재정 위기, 인구 이정표
- [ ] **건물 클릭 정보창** — 건물별 현황
- [ ] **구역 오버레이 토글** — 교통/유틸/오염/토지가치
- [ ] **설정 메뉴** — 음량, 그래픽 품질 (WebGL)
- [ ] 게임 저장/불러오기 UI

---

## Phase 8 — 폴리시 & WebGL 최적화
> 목표: 배포 가능한 품질
> 예상 기간: 3주

### 최적화
- [ ] GPU Instancing으로 건물 드로우콜 최소화
- [ ] Object Pool — 건물/도로 Prefab 관리
- [ ] LOD 설정 — 줌 아웃 시 간소화 메시
- [ ] 그리드 청크 단위 컬링 (화면 밖 비활성화)
- [ ] WebGL 메모리 프로파일링 (< 512MB 목표)

### 저장 시스템
- [ ] `SaveLoadSystem.cs` — JSON 직렬화
- [ ] WebGL IndexedDB 저장 (jslib 브릿지)
- [ ] 자동 저장 (5분 간격)

### 사운드 & 비주얼
- [ ] 앰비언트 사운드 (도시 소음, 자연)
- [ ] 건물 배치/철거 SFX
- [ ] 계절 변화 (봄/여름/가을/겨울) 색조 변화
- [ ] 낮/밤 사이클 (조명 변화)

### 배포
- [ ] GitHub Pages 또는 itch.io WebGL 배포
- [ ] 로딩 화면 커스터마이징
- [ ] 모바일 터치 UI 대응

---

## 마일스톤 요약

| 단계 | 완료 기준 | 목표 시기 |
|------|-----------|-----------|
| Phase 0 | 환경 세팅 완료 | ✅ 완료 |
| Phase 1 | 그리드 + 카메라 + 시계 동작 | ✅ 완료 |
| Phase 2 | 건물 배치/철거 동작 | 🔄 UI 패널 미구현 |
| Phase 3 | 도로+구역 자동 개발 동작 | Week 6~8 |
| Phase 4 | 인구+경제+유틸 시뮬레이션 | Week 9~12 |
| Phase 5 | 공공시설 서비스 동작 | Week 13~14 |
| Phase 6 | 교량/댐/지형 편집 | Week 15~17 |
| Phase 7 | UI 완성 | Week 18~19 |
| Phase 8 | 최적화+배포 | Week 20~22 |
